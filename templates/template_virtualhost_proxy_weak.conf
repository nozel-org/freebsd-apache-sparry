# apache configuration file generated by sparry
<VirtualHost *:80>
    ServerName <domain_name>
    ServerAlias www.<domain_name>

    # Logging
    ErrorLog "/var/log/httpd-<domain_name>-error.log"
    CustomLog "/var/log/httpd-<domain_name>-access.log" common

    # HTTP Security Headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection: "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Permitted-Cross-Domain-Policies: none
    Header always set Referrer-Policy same-origin
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName <domain_name>
    ServerAlias www.<domain_name>

    # proxy
    ProxyPreserveHost On
    ProxyPass / http://<domain_name>/
    ProxyPassReverse / http://<domain_name>/

    <Location "/">
        RequestHeader set X-Forwarded-Proto https
        RequestHeader set X-Forwarded-Ssl on
        RequestHeader set X-Url-Scheme https
    </Location>

    # Logging
    ErrorLog "/var/log/httpd-<domain_name>-error.log"
    CustomLog "/var/log/httpd-<domain_name>-access.log" common

    # HTTP Security Headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection: "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Permitted-Cross-Domain-Policies: none
    Header always set Referrer-Policy same-origin

    # Let's Encrypt configuration
    SSLCertificateFile /usr/local/etc/letsencrypt/live/<domain_name>/fullchain.pem
    SSLCertificateKeyFile /usr/local/etc/letsencrypt/live/<domain_name>/privkey.pem
    Include /usr/local/etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule>
